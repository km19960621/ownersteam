/*
 * Option Disable
 *   Enables the use of disabled select box options across all browsers.
 *   Uses optgroups and css to trick ie 7 and below into supporting disabled select box options.
 *   Supported browsers use the default disabled attribute.
 *
 * Version: 1.0
 * Copyright (c) 2009 Corey Downie 
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * Requires: jQuery 1.2+
 *
 * Usage:   $('#selectBox).optional([disabled],[optionText]);
 *
 * Examples
 * $('body').optional(); - applies the required hack to any elements marked with the disabled attribute
 * $('#selectBox).optional(true, 'Option Text'); - disables single option
 * $('#selectBox).optional(false, 'Option Text'); - enables single option
 *
 */
(function($){$.fn.optional=function(state,optionSelector){var style='color:#bbb;';var hack=$.browser.msie&&($.browser.version=="6.0"||$.browser.version=="7.0");return this.each(function(){var sel=$(this);if(optionSelector===undefined){optionSelector='option, optgroup.fakeopt';}
if(sel.is('select')){if($('style#fakeopt_style').length<=0){sel.append("<style id='fakeopt_style' type='text/css'>optgroup.fakeopt{"+style+"};</style>");}
var opts;if(hack){opts=sel.find(optionSelector+' ,optgroup.fakeopt'+optionSelector.replace('[text','[label'));}else{opts=sel.find(optionSelector);}
if(state=='disable'||state=='enable'){opts.each(function(){if($(this).is(':selected')){$(this).parent().get(0).selectedIndex=-1;}
set_option($(this),state,hack);});}else if(state==='toggle'){opts.each(function(){var opt=$(this);if(opt.is(':disabled')||opt.is('optgroup')){set_option(opt,'enable',hack);}else{set_option(opt,'disable',hack);}});}else if(state=='fix'){if(hack){sel.find('option[disabled]').each(function(){set_option($(this),'disable',hack);});}}}
function set_option(opt,state,hack){if(hack){if(state=='disable'&&opt.is('option')){opt.replaceWith("<optgroup class='fakeopt' value='"+opt.val()+"' label='"+opt.text()+"'/>");}else if(state=='enable'&&opt.is('optgroup')){opt.replaceWith("<option value='"+opt.attr('value')+"'>"+opt.attr('label')+"</option>");}}else{if(state=='disable'){opt.attr('disabled','disabled');}else if(state=='enable'){opt.removeAttr('disabled');}}}});};})(jQuery);